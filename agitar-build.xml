<?xml version="1.0" ?>
<project name="HpUftIntegration" default="agitar-all">
	
	
	<!-- Root directory of your eclipse installation -->
	<property name="eclipse.install.dir" value="C:/Program Files (x86)/Eclipse/5.0.2"/>
	<property name="agitarOne.install.dir" value="C:/Users/schalav/.eclipse/org.eclipse.platform_3.6.1_597748219"/>
	
	
	<!-- Override eclipse.java (using -Declipse.java) with the java your eclipse instance used -->
	<property name="eclipse.java" value="java"/>
	
	
	<!-- Override jvm with the java you wish to use for running tests -->
	<property name="jvm" value="java"/>
	<property name="dashboardURL.HpUftIntegration" value=""/>
	<property name="domain.access.key" value=""/>
	<property name="domain.email" value=""/>
	
	
	<!-- Use of ${project.dir.HpUftIntegration} allows for the resolution of relative paths even when this file is imported in another build file -->
	<dirname file="${ant.file.HpUftIntegration}" property="project.dir.HpUftIntegration"/>
	<condition property="project.dir.HpUftIntegration" value="${basedir}">
		<not>
			<isset property="project.dir.HpUftIntegration"/>
		</not>
	</condition>
	<property name="max.memory" value="1024m"/>
	<path id="agitar.possible.startup.jars">
		<pathelement location="${eclipse.install.dir}/startup.jar"/>
		<fileset dir="${eclipse.install.dir}/plugins/" includes="org.eclipse.equinox.launcher_*.jar"/>
	</path>
	
	
	<!-- Agitar Build Number (If this fails, add -ws win32|gtk|motif in front of -data as is appropriate for your platform.) -->
	<java fork="true" jvm="${eclipse.java}" classname="org.eclipse.core.launcher.Main" outputproperty="agitar.build.num" errorproperty="agitar.java.error">
		<arg line=" -data &quot;${user.home}/.agitar/.temp_workspace&quot; -application com.agitar.eclipse.cmdline.Version"/>
		<classpath refid="agitar.possible.startup.jars"/>
	</java>
	
	
	<!-- Location of the import files for the agitar ant tasks taskdefs -->
	<property name="agitarant.import.dir" value="${agitarOne.install.dir}/plugins/com.agitar.agitator_${agitar.build.num}/config"/>
	
	
	<!-- Import the agitar ant taskdefs -->
	<import file="${agitarant.import.dir}/agitar_ant.xml"/>
	
	
	<!-- Project Definitions -->
	
	
	
	<!-- Agitar project definition for HpUftIntegration project -->
	<agitar-project id="HpUftIntegration.project" projectDir="${project.dir.HpUftIntegration}" agitarDir="${project.dir.HpUftIntegration}/agitar" resultDir="${project.dir.HpUftIntegration}/agitar/.results" configDir="${project.dir.HpUftIntegration}/agitar/config" generatedTestDir="${project.dir.HpUftIntegration}/test" reportOutputDir="${project.dir.HpUftIntegration}/agitar/reports/latest" dataDir="${project.dir.HpUftIntegration}/agitar/reports/latest/data" authEmail="${domain.email}" accessKey="${domain.access.key}" agitationVmArgs="-Xms128m -Xmx512m" testGenerationVmArgs="-Xmx1024m" projectName="HpUftIntegration" dashboardRootURL="${dashboardURL.HpUftIntegration}" jvmVendor="Sun" jvmVersion="1.7.0_80" aggressiveMocks="true" importedCoverageDir="${project.dir.HpUftIntegration}/agitar/imports">
		<sourcePath>
			<pathElement location="${project.dir.HpUftIntegration}/src"/>
			<pathElement location="${project.dir.HpUftIntegration}/resources"/>
			<pathElement location="${project.dir.HpUftIntegration}/lib"/>
			<pathElement location="${project.dir.HpUftIntegration}/test"/>
		</sourcePath>
		<targetClasspath>
			<pathElement location="${project.dir.HpUftIntegration}/bin"/>
		</targetClasspath>
		<libClasspath>
			<pathElement location="${project.dir.HpUftIntegration}/lib/log4j-1.2.16.jar"/>
			<pathElement location="${project.dir.HpUftIntegration}/lib/jersey-client-2.25.jar"/>
			<pathElement location="${project.dir.HpUftIntegration}/lib/jersey-common-2.25.jar"/>
			<pathElement location="${project.dir.HpUftIntegration}/lib/junit-4.11.jar"/>
			<pathElement location="${project.dir.HpUftIntegration}/lib/jersey-bundle-1.19.1.jar"/>
			<pathElement location="${project.dir.HpUftIntegration}/../../Downloads/jersey-client-1.19.3.jar"/>
			<pathElement location="${project.dir.HpUftIntegration}/../../.eclipse/org.eclipse.platform_3.6.1_597748219/plugins/com.agitar.eclipse.api_${agitar.build.num}/com.agitar.mockingbird.jar"/>
			<pathElement location="${project.dir.HpUftIntegration}/../../.eclipse/org.eclipse.platform_3.6.1_597748219/plugins/com.agitar.eclipse.api_${agitar.build.num}/lib/ext/org.agitar.mock.jar"/>
			<pathElement location="${project.dir.HpUftIntegration}/../../.eclipse/org.eclipse.platform_3.6.1_597748219/plugins/com.agitar.eclipse.api_${agitar.build.num}/lib/ext/org.agitar.mock5.jar"/>
		</libClasspath>
		<testResultsPath>
			<pathElement location="${project.dir.HpUftIntegration}/agitar/.junitresults"/>
		</testResultsPath>
	</agitar-project>
	
	
	<!-- Configuration for HpUftIntegration -->
	<agitar-config id="HpUftIntegration.config" local="false" generateXMLDashboard="false" showCoverageDetails="true"/>
	
	
	<!-- Default target -->
	<target name="agitar-all" depends="agitate, run-tests, checkrules, quicklist, dashboard, email"/>
	
	
	<!-- Cleans old agitation results and coverage -->
	<target name="clean-results">
		<delete dir="${project.dir.HpUftIntegration}/agitar/.results" quiet="true"/>
	</target>
	
	
	<!-- Cleans old agitation and junit results, logs and dashboards -->
	<target name="clean-agitar">
		<delete dir="${project.dir.HpUftIntegration}/agitar/.results" quiet="true"/>
		<delete dir="${project.dir.HpUftIntegration}/agitar/.junitresults" quiet="true"/>
		<delete dir="${project.dir.HpUftIntegration}/agitar/.logs" quiet="true"/>
		<delete quiet="true" includeemptydirs="true">
			<fileset dir="${project.dir.HpUftIntegration}/agitar/reports/latest" excludes="**/*.ddf"/>
		</delete>
	</target>
	
	
	<!-- Agitates the project remotely on the server -->
	<target name="agitate" depends="clean-results">
		<agitate projectid="HpUftIntegration.project" configid="HpUftIntegration.config" maxmemory="${max.memory}">
			<agitar-config hasconfig="true"/>
		</agitate>
	</target>
	
	
	<!-- Generates tests for the project -->
	
	
	
	<!-- Add this target as a dependency to the agitar-all target to generate tests -->
	
	
	
	<!-- Compile these tests with a new compilation target to include them in test runs and dashboards -->
	<target name="generatetests">
		<generatetests projectid="HpUftIntegration.project" configid="HpUftIntegration.config"/>
	</target>
	
	
	<!-- Runs tests for this project on the AgitarOne server -->
	<target name="remoteruntests">
		<remoteruntests projectid="HpUftIntegration.project" configid="HpUftIntegration.config"/>
	</target>
	
	
	<!-- Run the code rules checker -->
	<target name="checkrules">
		<checkrules projectid="HpUftIntegration.project" configid="HpUftIntegration.config" maxmemory="${max.memory}"/>
	</target>
	
	
	<!-- Select classes for agitation -->
	<target name="quicklist">
		<quicklist projectid="HpUftIntegration.project" configid="HpUftIntegration.config"/>
	</target>
	
	
	<!-- Import external coverage -->
	<target name="importcoverage">
		<importcoverage projectid="HpUftIntegration.project" configid="HpUftIntegration.config" clearCoverage="false">
			<fileset dir="${user.home}/agitar_coverage">
				<include name="**/*.zcov"/>
			</fileset>
		</importcoverage>
	</target>
	
	
	<!-- Generate a dashboard -->
	<target name="dashboard">
		<dashboard projectid="HpUftIntegration.project" configid="HpUftIntegration.config" maxmemory="${max.memory}"/>
		<echo message="Dashboard generated at C:\Users\schalav\workspace\HpUftIntegration\agitar\reports\latest\index.html" level="info"/>
	</target>
	
	
	<!-- Email task -->
	<target name="email">
		<email projectid="HpUftIntegration.project" configid="HpUftIntegration.config"/>
	</target>
	
	
	<!-- Run the tests for this project -->
	<target name="run-tests">
		<property name="test.results.dir" value="${project.dir.HpUftIntegration}/agitar/.junitresults"/>
		<mkdir dir="${test.results.dir}"/>
		<super-runner dir="${project.dir.HpUftIntegration}" maxmemory="${max.memory}" batchSize="5" timeout="300000" printsummary="yes" haltonfailure="no" jvm="${jvm}" resultsDir="${project.dir.HpUftIntegration}/agitar/.results">
			<jvmarg value="-Xmx1024m"/>
			<jvmarg value="-ea"/>
			<jvmarg value="-Djava.awt.headless=true"/>
			<formatter type="xml"/>
			<classpath>
				<pathElement location="${project.dir.HpUftIntegration}/bin"/>
				<pathElement location="${project.dir.HpUftIntegration}/lib/log4j-1.2.16.jar"/>
				<pathElement location="${project.dir.HpUftIntegration}/lib/jersey-client-2.25.jar"/>
				<pathElement location="${project.dir.HpUftIntegration}/lib/jersey-common-2.25.jar"/>
				<pathElement location="${project.dir.HpUftIntegration}/lib/junit-4.11.jar"/>
				<pathElement location="${project.dir.HpUftIntegration}/lib/jersey-bundle-1.19.1.jar"/>
				<pathElement location="${project.dir.HpUftIntegration}/../../Downloads/jersey-client-1.19.3.jar"/>
				<pathElement location="${project.dir.HpUftIntegration}/../../.eclipse/org.eclipse.platform_3.6.1_597748219/plugins/com.agitar.eclipse.api_${agitar.build.num}/com.agitar.mockingbird.jar"/>
				<pathElement location="${project.dir.HpUftIntegration}/../../.eclipse/org.eclipse.platform_3.6.1_597748219/plugins/com.agitar.eclipse.api_${agitar.build.num}/lib/ext/org.agitar.mock.jar"/>
				<pathElement location="${project.dir.HpUftIntegration}/../../.eclipse/org.eclipse.platform_3.6.1_597748219/plugins/com.agitar.eclipse.api_${agitar.build.num}/lib/ext/org.agitar.mock5.jar"/>
			</classpath>
			<batchtest todir="${test.results.dir}">
				<fileset dir="${project.dir.HpUftIntegration}/bin">
					<include name="**/*Test.class"/>
					<include name="**/Test*.class"/>
					<include name="**/*AgitarTest*.class"/>
				</fileset>
			</batchtest>
		</super-runner>
	</target>
	
	
	<!-- Publish results to location ${artifacts.destination} -->
	<target name="publish">
		<mkdir dir="${project.dir.HpUftIntegration}/agitar/reports/latest/.logs"/>
		<copy todir="${project.dir.HpUftIntegration}/agitar/reports/latest/.logs">
			<fileset dir="${project.dir.HpUftIntegration}/agitar/.logs"/>
		</copy>
		<copy todir="${artifacts.destination}">
			<fileset dir="${project.dir.HpUftIntegration}/agitar/reports/latest"/>
		</copy>
	</target>
</project>
